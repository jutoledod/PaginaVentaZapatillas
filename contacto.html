<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SneakerStore - Contacto | Soporte y Consultas</title>
  
  <!-- SEO Meta Tags -->
  <meta name="description" content="¬øDudas sobre tallas, env√≠os o cambios? Cont√°ctanos en SneakerStore. Soporte especializado en zapatillas deportivas. Respuesta r√°pida garantizada.">
  <meta name="keywords" content="contacto sneakerstore, soporte zapatillas, consultas tallas, env√≠os, cambios, devoluciones">
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
  <link rel="stylesheet" href="css/styles.css"/>
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üëü</text></svg>">
</head>
<body>
  <!-- Navbar coherente (contador + admin-link) -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <i class="fas fa-running"></i> SneakerStore
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navContacto" aria-controls="navContacto" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navContacto">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">
              <i class="fas fa-home d-lg-none"></i> Inicio
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="productos.html">
              <i class="fas fa-shoe-prints d-lg-none"></i> Zapatillas
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="blogs.html">
              <i class="fas fa-blog d-lg-none"></i> Blog
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="nosotros.html">
              <i class="fas fa-users d-lg-none"></i> Nosotros
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="contacto.html" aria-current="page">
              <i class="fas fa-envelope d-lg-none"></i> Contacto
            </a>
          </li>
        </ul>
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="login.html">
              <i class="fas fa-sign-in-alt"></i> Login
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link carrito-btn" href="carrito.html" title="Ver carrito de compras">
              <i class="fas fa-shopping-cart"></i> (<span id="contador" aria-label="Productos en carrito">0</span>)
            </a>
          </li>
          <li class="nav-item admin-link">
            <a class="nav-link" href="admin/home.html" title="Panel administrativo">
              <i class="fas fa-cog"></i> Admin
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Breadcrumb -->
  <div class="container py-3">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="index.html">
            <i class="fas fa-home"></i> Inicio
          </a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">Contacto</li>
      </ol>
    </nav>
  </div>

  <!-- Cabecera -->
  <div class="container py-5">
    <div class="text-center mb-5">
      <h1 class="display-4 fw-bold">CONT√ÅCTANOS</h1>
      <p class="lead text-muted">¬øDudas sobre tallas, env√≠os o cambios? Estamos aqu√≠ para ayudarte.</p>
      <div class="underline-accent mx-auto"></div>
    </div>

    <div class="row g-5">
      <!-- Formulario mejorado -->
      <div class="col-lg-7">
        <!-- Estado de carga -->
        <div class="loading-form d-none" id="loading-form">
          <div class="text-center py-4">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Enviando mensaje...</span>
            </div>
            <p class="mt-2 text-muted">Enviando tu mensaje...</p>
          </div>
        </div>

        <div class="form-nike" id="form-container">
          <h2><i class="fas fa-comments"></i> Formulario de Contacto</h2>
          <p class="text-muted mb-4">Completa todos los campos y te responderemos en menos de 24 horas.</p>
          
          <form id="formContacto" novalidate>
            <!-- Campo Nombre -->
            <div class="mb-4">
              <label for="nombre" class="form-label fw-semibold">
                <i class="fas fa-user"></i> Nombre completo *
              </label>
              <input type="text" 
                     class="form-control form-control-nike" 
                     id="nombre" 
                     name="nombre"
                     placeholder="Tu nombre completo" 
                     maxlength="50" 
                     required 
                     autocomplete="name"
                     aria-describedby="error-nombre help-nombre">
              <div class="form-text" id="help-nombre">M√≠nimo 2 caracteres, m√°ximo 50</div>
              <div class="error-nike" id="error-nombre" role="alert"></div>
            </div>

            <!-- Campo Email -->
            <div class="mb-4">
              <label for="correo" class="form-label fw-semibold">
                <i class="fas fa-envelope"></i> Correo electr√≥nico *
              </label>
              <input type="email" 
                     class="form-control form-control-nike" 
                     id="correo" 
                     name="correo"
                     placeholder="tu@correo.com" 
                     maxlength="100" 
                     required 
                     autocomplete="email"
                     aria-describedby="error-correo help-correo">
              <div class="form-text" id="help-correo">Aceptamos: @duoc.cl, @profesor.duoc.cl, @gmail.com</div>
              <div class="error-nike" id="error-correo" role="alert"></div>
            </div>

            <!-- Campo Tel√©fono (opcional) -->
            <div class="mb-4">
              <label for="telefono" class="form-label fw-semibold">
                <i class="fas fa-phone"></i> Tel√©fono (opcional)
              </label>
              <input type="tel" 
                     class="form-control form-control-nike" 
                     id="telefono" 
                     name="telefono"
                     placeholder="+56 9 1234 5678" 
                     maxlength="15"
                     autocomplete="tel"
                     pattern="[\+]?[0-9\s\-\(\)]{8,15}"
                     aria-describedby="help-telefono">
              <div class="form-text" id="help-telefono">Formato: +56 9 1234 5678</div>
              <div class="error-nike" id="error-telefono" role="alert"></div>
            </div>

            <!-- Campo Motivo -->
            <div class="mb-4">
              <label for="motivo" class="form-label fw-semibold">
                <i class="fas fa-tags"></i> Motivo del contacto *
              </label>
              <select class="form-select form-control-nike" 
                      id="motivo" 
                      name="motivo"
                      required 
                      aria-describedby="error-motivo">
                <option value="">Selecciona un motivo</option>
                <option value="consulta-producto">Consulta sobre producto</option>
                <option value="soporte-tecnico">Soporte t√©cnico</option>
                <option value="pedido">Consulta de pedido</option>
                <option value="devolucion">Devoluciones/Cambios</option>
                <option value="tallas">Consulta de tallas</option>
                <option value="envios">Informaci√≥n de env√≠os</option>
                <option value="sugerencia">Sugerencias</option>
                <option value="reclamo">Reclamo</option>
                <option value="otro">Otro</option>
              </select>
              <div class="error-nike" id="error-motivo" role="alert"></div>
            </div>

            <!-- Campo Asunto -->
            <div class="mb-4">
              <label for="asunto" class="form-label fw-semibold">
                <i class="fas fa-heading"></i> Asunto *
              </label>
              <input type="text" 
                     class="form-control form-control-nike" 
                     id="asunto" 
                     name="asunto"
                     placeholder="Resumen breve de tu consulta" 
                     maxlength="100" 
                     required
                     aria-describedby="error-asunto help-asunto">
              <div class="form-text" id="help-asunto">Describe brevemente tu consulta (m√°x. 100 caracteres)</div>
              <div class="error-nike" id="error-asunto" role="alert"></div>
            </div>

            <!-- Campo Mensaje -->
            <div class="mb-4">
              <label for="mensaje" class="form-label fw-semibold">
                <i class="fas fa-comment"></i> Mensaje *
              </label>
              <textarea class="form-control form-control-nike" 
                        id="mensaje" 
                        name="mensaje"
                        rows="5" 
                        maxlength="1000" 
                        placeholder="Cu√©ntanos en detalle tu consulta o problema..."
                        required
                        aria-describedby="error-mensaje help-mensaje"></textarea>
              <div class="form-text d-flex justify-content-between" id="help-mensaje">
                <small>M√≠nimo 10 caracteres para una consulta efectiva</small>
                <small><span id="contador-caracteres">0</span>/1000</small>
              </div>
              <div class="error-nike" id="error-mensaje" role="alert"></div>
            </div>

            <!-- Campo Privacidad -->
            <div class="mb-4">
              <div class="form-check">
                <input class="form-check-input" 
                       type="checkbox" 
                       value="" 
                       id="privacidad" 
                       name="privacidad"
                       required
                       aria-describedby="error-privacidad">
                <label class="form-check-label" for="privacidad">
                  He le√≠do y acepto la <a href="#" class="text-decoration-none">pol√≠tica de privacidad</a> y el tratamiento de mis datos personales *
                </label>
                <div class="error-nike" id="error-privacidad" role="alert"></div>
              </div>
            </div>

            <!-- Bot√≥n Submit con estado -->
            <button type="submit" class="btn-nike w-100" id="btn-enviar">
              <i class="fas fa-paper-plane"></i> <span id="btn-text">ENVIAR MENSAJE</span>
            </button>
          </form>

          <!-- Mensaje de √©xito -->
          <div class="alert alert-success mt-4 d-none" id="exitoContacto" role="alert">
            <div class="d-flex align-items-center">
              <i class="fas fa-check-circle fa-2x text-success me-3"></i>
              <div>
                <h5 class="alert-heading mb-1">¬°Mensaje enviado exitosamente!</h5>
                <p class="mb-0">Te responderemos dentro de las pr√≥ximas 24 horas a tu correo electr√≥nico.</p>
              </div>
            </div>
          </div>

          <!-- Mensaje de error -->
          <div class="alert alert-danger mt-4 d-none" id="errorContacto" role="alert">
            <div class="d-flex align-items-center">
              <i class="fas fa-exclamation-triangle fa-2x text-danger me-3"></i>
              <div>
                <h5 class="alert-heading mb-1">Error al enviar mensaje</h5>
                <p class="mb-0" id="error-mensaje-detalle">Por favor, revisa los campos e intenta nuevamente.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Datos de contacto / ayuda mejorados -->
      <div class="col-lg-5">
        <div class="row g-4">
          <!-- Informaci√≥n de contacto -->
          <div class="col-12">
            <div class="card h-100 border-0 shadow-sm">
              <div class="card-body p-4">
                <h4 class="card-title mb-4">
                  <i class="fas fa-headset text-primary"></i> Informaci√≥n de Contacto
                </h4>
                
                <div class="contact-info">
                  <div class="contact-item mb-3">
                    <div class="d-flex align-items-center">
                      <div class="contact-icon">
                        <i class="fas fa-clock text-primary"></i>
                      </div>
                      <div class="contact-details">
                        <strong>Horario de Atenci√≥n</strong><br>
                        <span class="text-muted">Lun‚ÄìVie: 9:00 a 18:00<br>S√°b: 10:00 a 14:00</span>
                      </div>
                    </div>
                  </div>

                  <div class="contact-item mb-3">
                    <div class="d-flex align-items-center">
                      <div class="contact-icon">
                        <i class="fas fa-envelope text-primary"></i>
                      </div>
                      <div class="contact-details">
                        <strong>Email</strong><br>
                        <a href="mailto:soporte@sneakerstore.cl" class="text-muted">soporte@sneakerstore.cl</a>
                      </div>
                    </div>
                  </div>

                  <div class="contact-item mb-3">
                    <div class="d-flex align-items-center">
                      <div class="contact-icon">
                        <i class="fas fa-phone text-primary"></i>
                      </div>
                      <div class="contact-details">
                        <strong>Tel√©fono</strong><br>
                        <a href="tel:+56223456789" class="text-muted">+56 2 2345 6789</a>
                      </div>
                    </div>
                  </div>

                  <div class="contact-item mb-3">
                    <div class="d-flex align-items-center">
                      <div class="contact-icon">
                        <i class="fab fa-whatsapp text-success"></i>
                      </div>
                      <div class="contact-details">
                        <strong>WhatsApp</strong><br>
                        <a href="https://wa.me/56987654321" class="text-muted" target="_blank">+56 9 8765 4321</a>
                      </div>
                    </div>
                  </div>

                  <div class="contact-item">
                    <div class="d-flex align-items-center">
                      <div class="contact-icon">
                        <i class="fas fa-map-marker-alt text-primary"></i>
                      </div>
                      <div class="contact-details">
                        <strong>Direcci√≥n</strong><br>
                        <span class="text-muted">Av. Providencia 123<br>Providencia, Santiago</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Servicios -->
          <div class="col-12">
            <div class="card h-100 border-0 shadow-sm">
              <div class="card-body p-4">
                <h5 class="card-title mb-4">
                  <i class="fas fa-star text-warning"></i> Nuestros Servicios
                </h5>
                <ul class="list-unstyled services-list">
                  <li class="mb-2">
                    <i class="fas fa-shipping-fast text-success me-2"></i>
                    Env√≠os gratis sobre $50.000
                  </li>
                  <li class="mb-2">
                    <i class="fas fa-undo text-info me-2"></i>
                    Cambios dentro de 30 d√≠as
                  </li>
                  <li class="mb-2">
                    <i class="fas fa-shield-alt text-primary me-2"></i>
                    Garant√≠a de autenticidad
                  </li>
                  <li class="mb-2">
                    <i class="fas fa-credit-card text-warning me-2"></i>
                    Pago seguro y protegido
                  </li>
                  <li class="mb-2">
                    <i class="fas fa-ruler text-secondary me-2"></i>
                    Gu√≠a de tallas personalizada
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <!-- FAQ R√°pido -->
          <div class="col-12">
            <div class="card h-100 border-0 shadow-sm">
              <div class="card-body p-4">
                <h5 class="card-title mb-4">
                  <i class="fas fa-question-circle text-info"></i> Preguntas Frecuentes
                </h5>
                <div class="accordion accordion-flush" id="accordionFAQ">
                  <div class="accordion-item">
                    <h6 class="accordion-header">
                      <button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                        ¬øCu√°nto demoran los env√≠os?
                      </button>
                    </h6>
                    <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#accordionFAQ">
                      <div class="accordion-body py-2">
                        <small>Los env√≠os a Santiago demoran 1-2 d√≠as h√°biles. A regiones 2-4 d√≠as h√°biles.</small>
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h6 class="accordion-header">
                      <button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                        ¬øC√≥mo hago cambios?
                      </button>
                    </h6>
                    <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#accordionFAQ">
                      <div class="accordion-body py-2">
                        <small>Tienes 30 d√≠as desde la compra. El producto debe estar sin usar y con etiquetas.</small>
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h6 class="accordion-header">
                      <button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                        ¬øSon originales?
                      </button>
                    </h6>
                    <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#accordionFAQ">
                      <div class="accordion-body py-2">
                        <small>S√≠, todos nuestros productos son 100% originales con garant√≠a del fabricante.</small>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Disclaimer -->
        <div class="mt-4">
          <div class="alert alert-light border" role="note">
            <small class="text-muted">
              <i class="fas fa-info-circle"></i>
              <strong>Nota:</strong> Este formulario es demostrativo y no env√≠a correos reales. 
              En un entorno real, se implementar√≠a con un backend seguro.
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-white py-4 mt-5" role="contentinfo">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-6">
          <strong><i class="fas fa-running"></i> SneakerStore</strong> ‚Äî ¬øNecesitas ayuda? Estamos para ti
        </div>
        <div class="col-md-6 text-md-end">
          &copy; 2024 SneakerStore. Todos los derechos reservados.
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/validaciones.js"></script>
  <script src="js/carrito.js"></script>
  <script src="js/main.js"></script>

  <script>
    // Variables globales
    let formularioEnviando = false;

    // Inicializaci√≥n mejorada del formulario de contacto
    function inicializarFormularioContacto() {
      const form = document.getElementById('formContacto');
      if (!form) return;

      try {
        // Inicializar contador de caracteres
        inicializarContadorCaracteres();
        
        // Validaci√≥n en tiempo real
        inicializarValidacionTiempoReal();

        // Manejar submit del formulario
        form.addEventListener('submit', manejarSubmitFormulario);

      } catch (error) {
        console.error('Error al inicializar formulario de contacto:', error);
      }
    }

    // Contador de caracteres para textarea
    function inicializarContadorCaracteres() {
      const textarea = document.getElementById('mensaje');
      const contador = document.getElementById('contador-caracteres');
      
      if (!textarea || !contador) return;

      textarea.addEventListener('input', function() {
        const longitud = this.value.length;
        contador.textContent = longitud;
        
        // Cambiar color seg√∫n proximidad al l√≠mite
        if (longitud > 900) {
          contador.className = 'text-danger fw-bold';
        } else if (longitud > 750) {
          contador.className = 'text-warning fw-bold';
        } else {
          contador.className = 'text-muted';
        }
      });
    }

    // Validaci√≥n en tiempo real
    function inicializarValidacionTiempoReal() {
      const campos = ['nombre', 'correo', 'telefono', 'asunto', 'mensaje'];
      
      campos.forEach(campo => {
        const input = document.getElementById(campo);
        if (input) {
          input.addEventListener('blur', () => validarCampo(campo));
          input.addEventListener('input', () => limpiarErrorSiValido(campo));
        }
      });

      // Validaci√≥n especial para select
      const motivo = document.getElementById('motivo');
      if (motivo) {
        motivo.addEventListener('change', () => validarCampo('motivo'));
      }

      // Validaci√≥n para checkbox
      const privacidad = document.getElementById('privacidad');
      if (privacidad) {
        privacidad.addEventListener('change', () => validarCampo('privacidad'));
      }
    }

    // Validar campo individual
    function validarCampo(nombreCampo) {
      try {
        const input = document.getElementById(nombreCampo);
        if (!input) return false;

        const valor = input.value.trim();
        let esValido = true;
        let mensajeError = '';

        switch (nombreCampo) {
          case 'nombre':
            if (!valor) {
              mensajeError = 'El nombre es obligatorio';
              esValido = false;
            } else if (valor.length < 2) {
              mensajeError = 'El nombre debe tener al menos 2 caracteres';
              esValido = false;
            } else if (valor.length > 50) {
              mensajeError = 'El nombre no puede tener m√°s de 50 caracteres';
              esValido = false;
            } else if (!/^[a-zA-Z√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë\s]+$/.test(valor)) {
              mensajeError = 'El nombre solo puede contener letras y espacios';
              esValido = false;
            }
            break;

          case 'correo':
            if (!valor) {
              mensajeError = 'El correo electr√≥nico es obligatorio';
              esValido = false;
            } else if (typeof validarEmail === 'function') {
              if (!validarEmail(valor)) {
                mensajeError = 'Correo inv√°lido o dominio no permitido';
                esValido = false;
              }
            } else {
              // Validaci√≥n b√°sica si no existe la funci√≥n
              if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(valor)) {
                mensajeError = 'Formato de correo inv√°lido';
                esValido = false;
              }
            }
            break;

          case 'telefono':
            // Campo opcional, solo validar si hay valor
            if (valor && !/^[\+]?[0-9\s\-\(\)]{8,15}$/.test(valor)) {
              mensajeError = 'Formato de tel√©fono inv√°lido';
              esValido = false;
            }
            break;

          case 'motivo':
            if (!valor) {
              mensajeError = 'Debes seleccionar un motivo de contacto';
              esValido = false;
            }
            break;

          case 'asunto':
            if (!valor) {
              mensajeError = 'El asunto es obligatorio';
              esValido = false;
            } else if (valor.length < 5) {
              mensajeError = 'El asunto debe tener al menos 5 caracteres';
              esValido = false;
            } else if (valor.length > 100) {
              mensajeError = 'El asunto no puede tener m√°s de 100 caracteres';
              esValido = false;
            }
            break;

          case 'mensaje':
            if (!valor) {
              mensajeError = 'El mensaje es obligatorio';
              esValido = false;
            } else if (valor.length < 10) {
              mensajeError = 'El mensaje debe tener al menos 10 caracteres';
              esValido = false;
            } else if (valor.length > 1000) {
              mensajeError = 'El mensaje no puede tener m√°s de 1000 caracteres';
              esValido = false;
            }
            break;

          case 'privacidad':
            if (!input.checked) {
              mensajeError = 'Debes aceptar la pol√≠tica de privacidad';
              esValido = false;
            }
            break;
        }

        // Sanitizar mensaje de error
        if (mensajeError && typeof sanitizarTexto === 'function') {
          mensajeError = sanitizarTexto(mensajeError);
        }

        // Mostrar u ocultar error
        if (esValido) {
          if (typeof limpiarError === 'function') {
            limpiarError(nombreCampo);
          }
          input.classList.remove('is-invalid');
          input.classList.add('is-valid');
        } else {
          if (typeof mostrarError === 'function') {
            mostrarError(nombreCampo, mensajeError);
          }
          input.classList.remove('is-valid');
          input.classList.add('is-invalid');
        }

        return esValido;

      } catch (error) {
        console.error(`Error validando campo ${nombreCampo}:`, error);
        return false;
      }
    }

    // Limpiar error si el campo se vuelve v√°lido
    function limpiarErrorSiValido(nombreCampo) {
      const input = document.getElementById(nombreCampo);
      if (input && input.classList.contains('is-invalid')) {
        // Solo re-validar si antes estaba inv√°lido
        setTimeout(() => validarCampo(nombreCampo), 300);
      }
    }

    // Manejar submit del formulario
    async function manejarSubmitFormulario(e) {
      e.preventDefault();
      
      if (formularioEnviando) return;

      try {
        // Ocultar mensajes anteriores
        ocultarMensajes();

        // Validar todos los campos
        const camposObligatorios = ['nombre', 'correo', 'motivo', 'asunto', 'mensaje', 'privacidad'];
        const camposOpcionales = ['telefono'];
        
        let formularioValido = true;

        // Validar campos obligatorios
        camposObligatorios.forEach(campo => {
          const esValido = validarCampo(campo);
          if (!esValido) formularioValido = false;
        });

        // Validar campos opcionales solo si tienen valor
        camposOpcionales.forEach(campo => {
          const input = document.getElementById(campo);
          if (input && input.value.trim()) {
            const esValido = validarCampo(campo);
            if (!esValido) formularioValido = false;
          }
        });

        if (!formularioValido) {
          mostrarMensajeError('Por favor, corrige los errores en el formulario.');
          // Enfocar primer campo con error
          const primerError = document.querySelector('.is-invalid');
          if (primerError) {
            primerError.focus();
            primerError.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
          return;
        }

        // Procesar env√≠o
        await procesarEnvioFormulario();

      } catch (error) {
        console.error('Error al procesar formulario:', error);
        mostrarMensajeError('Error inesperado. Por favor, intenta nuevamente.');
      }
    }

    // Procesar env√≠o del formulario
    async function procesarEnvioFormulario() {
      formularioEnviando = true;
      
      // Mostrar estado de carga
      mostrarEstadoCarga(true);

      try {
        // Recopilar datos del formulario de manera segura
        const datosFormulario = recopilarDatosFormulario();

        // Simular env√≠o (en producci√≥n ser√≠a una llamada real al backend)
        await simularEnvioFormulario(datosFormulario);

        // √âxito
        mostrarMensajeExito();
        limpiarFormulario();

      } catch (error) {
        console.error('Error en env√≠o de formulario:', error);
        mostrarMensajeError('Error al enviar el mensaje. Por favor, intenta nuevamente.');
      } finally {
        formularioEnviando = false;
        mostrarEstadoCarga(false);
      }
    }

    // Recopilar datos del formulario de manera segura
    function recopilarDatosFormulario() {
      const datos = {};
      const campos = ['nombre', 'correo', 'telefono', 'motivo', 'asunto', 'mensaje'];
      
      campos.forEach(campo => {
        const input = document.getElementById(campo);
        if (input) {
          let valor = input.value.trim();
          // Sanitizar datos si la funci√≥n est√° disponible
          if (typeof sanitizarTexto === 'function') {
            valor = sanitizarTexto(valor);
          }
          datos[campo] = valor;
        }
      });

      datos.timestamp = new Date().toISOString();
      datos.userAgent = navigator.userAgent;
      
      return datos;
    }

    // Simular env√≠o (en producci√≥n ser√≠a una llamada real)
    function simularEnvioFormulario(datos) {
      return new Promise((resolve, reject) => {
        // Simular tiempo de respuesta del servidor
        setTimeout(() => {
          // Simular √©xito en 90% de los casos
          if (Math.random() > 0.1) {
            console.log('Datos del formulario (demo):', datos);
            resolve();
          } else {
            reject(new Error('Error simulado del servidor'));
          }
        }, 1500 + Math.random() * 1000);
      });
    }

    // Mostrar/ocultar estado de carga
    function mostrarEstadoCarga(mostrar) {
      const loading = document.getElementById('loading-form');
      const container = document.getElementById('form-container');
      const btnEnviar = document.getElementById('btn-enviar');
      const btnText = document.getElementById('btn-text');

      if (loading) loading.classList.toggle('d-none', !mostrar);
      if (container) container.style.opacity = mostrar ? '0.6' : '1';
      
      if (btnEnviar && btnText) {
        btnEnviar.disabled = mostrar;
        if (mostrar) {
          btnText.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>ENVIANDO...';
        } else {
          btnText.innerHTML = 'ENVIAR MENSAJE';
        }
      }
    }

    // Mostrar mensaje de √©xito
    function mostrarMensajeExito() {
      const mensaje = document.getElementById('exitoContacto');
      if (mensaje) {
        mensaje.classList.remove('d-none');
        mensaje.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    // Mostrar mensaje de error
    function mostrarMensajeError(texto) {
      const mensaje = document.getElementById('errorContacto');
      const detalle = document.getElementById('error-mensaje-detalle');
      
      if (mensaje) {
        mensaje.classList.remove('d-none');
        if (detalle) detalle.textContent = texto;
        mensaje.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    // Ocultar todos los mensajes
    function ocultarMensajes() {
      const mensajes = ['exitoContacto', 'errorContacto'];
      mensajes.forEach(id => {
        const elemento = document.getElementById(id);
        if (elemento) elemento.classList.add('d-none');
      });
    }

    // Limpiar formulario
    function limpiarFormulario() {
      const form = document.getElementById('formContacto');
      if (form) {
        form.reset();
        
        // Limpiar clases de validaci√≥n
        form.querySelectorAll('.is-valid, .is-invalid').forEach(input => {
          input.classList.remove('is-valid', 'is-invalid');
        });

        // Limpiar errores visibles
        form.querySelectorAll('.error-nike').forEach(error => {
          error.style.display = 'none';
          error.textContent = '';
        });

        // Resetear contador de caracteres
        const contador = document.getElementById('contador-caracteres');
        if (contador) {
          contador.textContent = '0';
          contador.className = 'text-muted';
        }
      }
    }

    // Inicializaci√≥n global
    document.addEventListener('DOMContentLoaded', function () {
      try {
        if (typeof cargarCarrito === 'function') cargarCarrito();
        if (typeof verificarSesionAdmin === 'function') verificarSesionAdmin();
        inicializarFormularioContacto();
      } catch (error) {
        console.error('Error en inicializaci√≥n:', error);
      }
    });
  </script>

  <style>
    .underline-accent {
      width: 60px;
      height: 4px;
      background: linear-gradient(90deg, var(--negro), var(--naranja));
      border-radius: 2px;
    }

    .contact-icon {
      width: 40px;
      flex-shrink: 0;
    }

    .contact-item {
      padding: 1rem 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .contact-item:last-child {
      border-bottom: none;
    }

    .services-list li {
      padding: 0.5rem 0;
      border-bottom: 1px solid #f8f9fa;
    }

    .services-list li:last-child {
      border-bottom: none;
    }

    .form-control-nike.is-valid {
      border-bottom-color: var(--success);
    }

    .form-control-nike.is-invalid {
      border-bottom-color: var(--danger);
    }

    .accordion-button {
      font-size: 0.9rem;
      background: none;
      border: none;
      box-shadow: none;
    }

    .accordion-button:not(.collapsed) {
      color: var(--negro);
      background: none;
    }

    .accordion-button:focus {
      box-shadow: none;
      border: none;
    }

    .loading-form {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      backdrop-filter: blur(2px);
    }

    @media (max-width: 768px) {
      .contact-item {
        padding: 0.75rem 0;
      }
      
      .form-nike {
        margin: 20px;
        padding: 30px 25px;
      }
    }
  </style>
</body>
</html>
